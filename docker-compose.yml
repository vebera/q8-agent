services:
  q8-agent:
    build: .
    container_name: q8-agent
    restart: unless-stopped
    ports:
      - "${Q8_AGENT_PORT:-8080}:${Q8_AGENT_PORT:-8080}"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${Q8_TENANTS_ROOT:-/opt/tenants}:${Q8_TENANTS_ROOT:-/opt/tenants}
    environment:
      - Q8_AGENT_PORT=${Q8_AGENT_PORT:-8080}
      - Q8_AGENT_ADMIN_TOKEN=${Q8_AGENT_ADMIN_TOKEN}
      - Q8_TENANTS_ROOT=${Q8_TENANTS_ROOT:-/opt/tenants}
    networks:
      - q8-network

networks:
  q8-network:
    external: true
    name: q8-traefik-network # Assuming it needs to be on a shared network or reachable by main server
